{% extends 'base2.html.twig' %}

{% block title %}Modifier la Recette{% endblock %}

{% block body %}
    <div class="container mt-4">
        <h1>Modifier la Recette</h1>

        {{ form_start(form) }}

        <div class="form-group">
            {{ form_label(form.name) }}
            {{ form_widget(form.name, { 'attr': {'class': 'form-control'} }) }}
        </div>

        <div class="form-group">
            {{ form_label(form.duration) }}
            {{ form_widget(form.duration, { 'attr': {'class': 'form-control'} }) }}
        </div>

        <h3>Ingrédients</h3>
        <div class="form-group ingredient-collection-wrapper">
            <div class="ingredient-collection" data-prototype="{{ form_widget(form.ingredients.vars.prototype)|e }}">
                {% for ingredient in form.ingredients %}
                    <div class="form-group col-md-12">
                        {{ form_widget(ingredient, { 'attr': {'class': 'form-control'} }) }}
                    </div>
                {% endfor %}
            </div>
            <button type="button" class="btn btn-secondary add-ingredient-btn">Ajouter Ingredient</button>
        </div>

        <div class="form-group mt-3">
            <button type="submit" class="btn btn-success">Enregistrer</button>
            <a href="{{ path('recipes_list') }}" class="btn btn-secondary">Retour à la liste</a>
        </div>

        {{ form_end(form) }}
    </div>

    <script>
        // Script to dynamically add ingredients (similar to create template)
        document.querySelector('.add-ingredient-btn').addEventListener('click', function () {
            var collectionHolder = document.querySelector('.ingredient-collection');
            var prototype = collectionHolder.getAttribute('data-prototype');
            var index = collectionHolder.children.length;
            var newForm = prototype.replace(/__name__/g, index);
            collectionHolder.insertAdjacentHTML('beforeend', newForm);
        });
    </script>
{% endblock %}
